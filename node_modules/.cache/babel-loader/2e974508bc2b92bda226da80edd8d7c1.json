{"ast":null,"code":"\"use strict\";\n\nconst whatwgURL = require(\"whatwg-url\");\n\nconst {\n  parseURLToResultingURLRecord\n} = require(\"../helpers/document-base-url\");\n\nconst {\n  asciiCaseInsensitiveMatch\n} = require(\"../helpers/strings\");\n\nconst {\n  navigate\n} = require(\"../window/navigation\");\n\nexports.implementation = class HTMLHyperlinkElementUtilsImpl {\n  _htmlHyperlinkElementUtilsSetup() {\n    this.url = null;\n  } // https://html.spec.whatwg.org/multipage/links.html#cannot-navigate\n\n\n  _cannotNavigate() {\n    // TODO: Correctly check if the document is fully active\n    return this._localName !== \"a\" && !this.isConnected;\n  } // https://html.spec.whatwg.org/multipage/semantics.html#get-an-element's-target\n\n\n  _getAnElementsTarget() {\n    if (this.hasAttributeNS(null, \"target\")) {\n      return this.getAttributeNS(null, \"target\");\n    }\n\n    const baseEl = this._ownerDocument.querySelector(\"base[target]\");\n\n    if (baseEl) {\n      return baseEl.getAttributeNS(null, \"target\");\n    }\n\n    return \"\";\n  } // https://html.spec.whatwg.org/multipage/browsers.html#the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name\n\n\n  _chooseABrowsingContext(name, current) {\n    let chosen = null;\n\n    if (name === \"\" || asciiCaseInsensitiveMatch(name, \"_self\")) {\n      chosen = current;\n    } else if (asciiCaseInsensitiveMatch(name, \"_parent\")) {\n      chosen = current.parent;\n    } else if (asciiCaseInsensitiveMatch(name, \"_top\")) {\n      chosen = current.top;\n    } else if (!asciiCaseInsensitiveMatch(name, \"_blank\")) {// https://github.com/whatwg/html/issues/1440\n    } // TODO: Create new browsing context, handle noopener\n\n\n    return chosen;\n  } // https://html.spec.whatwg.org/multipage/links.html#following-hyperlinks-2\n\n\n  _followAHyperlink() {\n    if (this._cannotNavigate()) {\n      return;\n    }\n\n    const source = this._ownerDocument._defaultView;\n    let targetAttributeValue = \"\";\n\n    if (this._localName === \"a\" || this._localName === \"area\") {\n      targetAttributeValue = this._getAnElementsTarget();\n    }\n\n    const noopener = this.relList.contains(\"noreferrer\") || this.relList.contains(\"noopener\");\n\n    const target = this._chooseABrowsingContext(targetAttributeValue, source, noopener);\n\n    if (target === null) {\n      return;\n    }\n\n    const url = parseURLToResultingURLRecord(this.href, this._ownerDocument);\n\n    if (url === null) {\n      return;\n    } // TODO: Handle hyperlink suffix and referrerpolicy\n\n\n    setTimeout(() => {\n      navigate(target, url, {});\n    }, 0);\n  }\n\n  toString() {\n    return this.href;\n  }\n\n  get href() {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null) {\n      const href = this.getAttributeNS(null, \"href\");\n      return href === null ? \"\" : href;\n    }\n\n    return whatwgURL.serializeURL(url);\n  }\n\n  set href(v) {\n    this.setAttributeNS(null, \"href\", v);\n  }\n\n  get origin() {\n    reinitializeURL(this);\n\n    if (this.url === null) {\n      return \"\";\n    }\n\n    return whatwgURL.serializeURLOrigin(this.url);\n  }\n\n  get protocol() {\n    reinitializeURL(this);\n\n    if (this.url === null) {\n      return \":\";\n    }\n\n    return this.url.scheme + \":\";\n  }\n\n  set protocol(v) {\n    reinitializeURL(this);\n\n    if (this.url === null) {\n      return;\n    }\n\n    whatwgURL.basicURLParse(v + \":\", {\n      url: this.url,\n      stateOverride: \"scheme start\"\n    });\n    updateHref(this);\n  }\n\n  get username() {\n    reinitializeURL(this);\n\n    if (this.url === null) {\n      return \"\";\n    }\n\n    return this.url.username;\n  }\n\n  set username(v) {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null || url.host === null || url.host === \"\" || url.cannotBeABaseURL || url.scheme === \"file\") {\n      return;\n    }\n\n    whatwgURL.setTheUsername(url, v);\n    updateHref(this);\n  }\n\n  get password() {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null) {\n      return \"\";\n    }\n\n    return url.password;\n  }\n\n  set password(v) {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null || url.host === null || url.host === \"\" || url.cannotBeABaseURL || url.scheme === \"file\") {\n      return;\n    }\n\n    whatwgURL.setThePassword(url, v);\n    updateHref(this);\n  }\n\n  get host() {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null || url.host === null) {\n      return \"\";\n    }\n\n    if (url.port === null) {\n      return whatwgURL.serializeHost(url.host);\n    }\n\n    return whatwgURL.serializeHost(url.host) + \":\" + whatwgURL.serializeInteger(url.port);\n  }\n\n  set host(v) {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null || url.cannotBeABaseURL) {\n      return;\n    }\n\n    whatwgURL.basicURLParse(v, {\n      url,\n      stateOverride: \"host\"\n    });\n    updateHref(this);\n  }\n\n  get hostname() {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null || url.host === null) {\n      return \"\";\n    }\n\n    return whatwgURL.serializeHost(url.host);\n  }\n\n  set hostname(v) {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null || url.cannotBeABaseURL) {\n      return;\n    }\n\n    whatwgURL.basicURLParse(v, {\n      url,\n      stateOverride: \"hostname\"\n    });\n    updateHref(this);\n  }\n\n  get port() {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null || url.port === null) {\n      return \"\";\n    }\n\n    return whatwgURL.serializeInteger(url.port);\n  }\n\n  set port(v) {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null || url.host === null || url.host === \"\" || url.cannotBeABaseURL || url.scheme === \"file\") {\n      return;\n    }\n\n    if (v === \"\") {\n      url.port = null;\n    } else {\n      whatwgURL.basicURLParse(v, {\n        url,\n        stateOverride: \"port\"\n      });\n    }\n\n    updateHref(this);\n  }\n\n  get pathname() {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null) {\n      return \"\";\n    }\n\n    if (url.cannotBeABaseURL) {\n      return url.path[0];\n    }\n\n    return \"/\" + url.path.join(\"/\");\n  }\n\n  set pathname(v) {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null || url.cannotBeABaseURL) {\n      return;\n    }\n\n    url.path = [];\n    whatwgURL.basicURLParse(v, {\n      url,\n      stateOverride: \"path start\"\n    });\n    updateHref(this);\n  }\n\n  get search() {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null || url.query === null || url.query === \"\") {\n      return \"\";\n    }\n\n    return \"?\" + url.query;\n  }\n\n  set search(v) {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null) {\n      return;\n    }\n\n    if (v === \"\") {\n      url.query = null;\n    } else {\n      const input = v[0] === \"?\" ? v.substring(1) : v;\n      url.query = \"\";\n      whatwgURL.basicURLParse(input, {\n        url,\n        stateOverride: \"query\",\n        encodingOverride: this._ownerDocument.charset\n      });\n    }\n\n    updateHref(this);\n  }\n\n  get hash() {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null || url.fragment === null || url.fragment === \"\") {\n      return \"\";\n    }\n\n    return \"#\" + url.fragment;\n  }\n\n  set hash(v) {\n    reinitializeURL(this);\n    const {\n      url\n    } = this;\n\n    if (url === null) {\n      return;\n    }\n\n    if (v === \"\") {\n      url.fragment = null;\n    } else {\n      const input = v[0] === \"#\" ? v.substring(1) : v;\n      url.fragment = \"\";\n      whatwgURL.basicURLParse(input, {\n        url,\n        stateOverride: \"fragment\"\n      });\n    }\n\n    updateHref(this);\n  }\n\n};\n\nfunction reinitializeURL(hheu) {\n  if (hheu.url !== null && hheu.url.scheme === \"blob\" && hheu.url.cannotBeABaseURL) {\n    return;\n  }\n\n  setTheURL(hheu);\n}\n\nfunction setTheURL(hheu) {\n  const href = hheu.getAttributeNS(null, \"href\");\n\n  if (href === null) {\n    hheu.url = null;\n    return;\n  }\n\n  const parsed = parseURLToResultingURLRecord(href, hheu._ownerDocument);\n  hheu.url = parsed === null ? null : parsed;\n}\n\nfunction updateHref(hheu) {\n  hheu.setAttributeNS(null, \"href\", whatwgURL.serializeURL(hheu.url));\n}","map":{"version":3,"sources":["/Library/WebServer/Documents/capstone/capstone-project-re-coder/node_modules/jsdom/lib/jsdom/living/nodes/HTMLHyperlinkElementUtils-impl.js"],"names":["whatwgURL","require","parseURLToResultingURLRecord","asciiCaseInsensitiveMatch","navigate","exports","implementation","HTMLHyperlinkElementUtilsImpl","_htmlHyperlinkElementUtilsSetup","url","_cannotNavigate","_localName","isConnected","_getAnElementsTarget","hasAttributeNS","getAttributeNS","baseEl","_ownerDocument","querySelector","_chooseABrowsingContext","name","current","chosen","parent","top","_followAHyperlink","source","_defaultView","targetAttributeValue","noopener","relList","contains","target","href","setTimeout","toString","reinitializeURL","serializeURL","v","setAttributeNS","origin","serializeURLOrigin","protocol","scheme","basicURLParse","stateOverride","updateHref","username","host","cannotBeABaseURL","setTheUsername","password","setThePassword","port","serializeHost","serializeInteger","hostname","pathname","path","join","search","query","input","substring","encodingOverride","charset","hash","fragment","hheu","setTheURL","parsed"],"mappings":"AAAA;;AACA,MAAMA,SAAS,GAAGC,OAAO,CAAC,YAAD,CAAzB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAmCD,OAAO,CAAC,8BAAD,CAAhD;;AACA,MAAM;AAAEE,EAAAA;AAAF,IAAgCF,OAAO,CAAC,oBAAD,CAA7C;;AACA,MAAM;AAAEG,EAAAA;AAAF,IAAeH,OAAO,CAAC,sBAAD,CAA5B;;AAEAI,OAAO,CAACC,cAAR,GAAyB,MAAMC,6BAAN,CAAoC;AAC3DC,EAAAA,+BAA+B,GAAG;AAChC,SAAKC,GAAL,GAAW,IAAX;AACD,GAH0D,CAK3D;;;AACAC,EAAAA,eAAe,GAAG;AAChB;AACA,WAAO,KAAKC,UAAL,KAAoB,GAApB,IAA2B,CAAC,KAAKC,WAAxC;AACD,GAT0D,CAW3D;;;AACAC,EAAAA,oBAAoB,GAAG;AACrB,QAAI,KAAKC,cAAL,CAAoB,IAApB,EAA0B,QAA1B,CAAJ,EAAyC;AACvC,aAAO,KAAKC,cAAL,CAAoB,IAApB,EAA0B,QAA1B,CAAP;AACD;;AAED,UAAMC,MAAM,GAAG,KAAKC,cAAL,CAAoBC,aAApB,CAAkC,cAAlC,CAAf;;AAEA,QAAIF,MAAJ,EAAY;AACV,aAAOA,MAAM,CAACD,cAAP,CAAsB,IAAtB,EAA4B,QAA5B,CAAP;AACD;;AAED,WAAO,EAAP;AACD,GAxB0D,CA0B3D;;;AACAI,EAAAA,uBAAuB,CAACC,IAAD,EAAOC,OAAP,EAAgB;AACrC,QAAIC,MAAM,GAAG,IAAb;;AAEA,QAAIF,IAAI,KAAK,EAAT,IAAejB,yBAAyB,CAACiB,IAAD,EAAO,OAAP,CAA5C,EAA6D;AAC3DE,MAAAA,MAAM,GAAGD,OAAT;AACD,KAFD,MAEO,IAAIlB,yBAAyB,CAACiB,IAAD,EAAO,SAAP,CAA7B,EAAgD;AACrDE,MAAAA,MAAM,GAAGD,OAAO,CAACE,MAAjB;AACD,KAFM,MAEA,IAAIpB,yBAAyB,CAACiB,IAAD,EAAO,MAAP,CAA7B,EAA6C;AAClDE,MAAAA,MAAM,GAAGD,OAAO,CAACG,GAAjB;AACD,KAFM,MAEA,IAAI,CAACrB,yBAAyB,CAACiB,IAAD,EAAO,QAAP,CAA9B,EAAgD,CACrD;AACD,KAXoC,CAarC;;;AAEA,WAAOE,MAAP;AACD,GA3C0D,CA6C3D;;;AACAG,EAAAA,iBAAiB,GAAG;AAClB,QAAI,KAAKf,eAAL,EAAJ,EAA4B;AAC1B;AACD;;AAED,UAAMgB,MAAM,GAAG,KAAKT,cAAL,CAAoBU,YAAnC;AACA,QAAIC,oBAAoB,GAAG,EAA3B;;AAEA,QAAI,KAAKjB,UAAL,KAAoB,GAApB,IAA2B,KAAKA,UAAL,KAAoB,MAAnD,EAA2D;AACzDiB,MAAAA,oBAAoB,GAAG,KAAKf,oBAAL,EAAvB;AACD;;AAED,UAAMgB,QAAQ,GAAG,KAAKC,OAAL,CAAaC,QAAb,CAAsB,YAAtB,KAAuC,KAAKD,OAAL,CAAaC,QAAb,CAAsB,UAAtB,CAAxD;;AAEA,UAAMC,MAAM,GAAG,KAAKb,uBAAL,CAA6BS,oBAA7B,EAAmDF,MAAnD,EAA2DG,QAA3D,CAAf;;AAEA,QAAIG,MAAM,KAAK,IAAf,EAAqB;AACnB;AACD;;AAED,UAAMvB,GAAG,GAAGP,4BAA4B,CAAC,KAAK+B,IAAN,EAAY,KAAKhB,cAAjB,CAAxC;;AAEA,QAAIR,GAAG,KAAK,IAAZ,EAAkB;AAChB;AACD,KAxBiB,CA0BlB;;;AACAyB,IAAAA,UAAU,CAAC,MAAM;AACf9B,MAAAA,QAAQ,CAAC4B,MAAD,EAASvB,GAAT,EAAc,EAAd,CAAR;AACD,KAFS,EAEP,CAFO,CAAV;AAGD;;AAED0B,EAAAA,QAAQ,GAAG;AACT,WAAO,KAAKF,IAAZ;AACD;;AAEO,MAAJA,IAAI,GAAG;AACTG,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAZ,EAAkB;AAChB,YAAMwB,IAAI,GAAG,KAAKlB,cAAL,CAAoB,IAApB,EAA0B,MAA1B,CAAb;AACA,aAAOkB,IAAI,KAAK,IAAT,GAAgB,EAAhB,GAAqBA,IAA5B;AACD;;AAED,WAAOjC,SAAS,CAACqC,YAAV,CAAuB5B,GAAvB,CAAP;AACD;;AAEO,MAAJwB,IAAI,CAACK,CAAD,EAAI;AACV,SAAKC,cAAL,CAAoB,IAApB,EAA0B,MAA1B,EAAkCD,CAAlC;AACD;;AAES,MAANE,MAAM,GAAG;AACXJ,IAAAA,eAAe,CAAC,IAAD,CAAf;;AAEA,QAAI,KAAK3B,GAAL,KAAa,IAAjB,EAAuB;AACrB,aAAO,EAAP;AACD;;AAED,WAAOT,SAAS,CAACyC,kBAAV,CAA6B,KAAKhC,GAAlC,CAAP;AACD;;AAEW,MAARiC,QAAQ,GAAG;AACbN,IAAAA,eAAe,CAAC,IAAD,CAAf;;AAEA,QAAI,KAAK3B,GAAL,KAAa,IAAjB,EAAuB;AACrB,aAAO,GAAP;AACD;;AAED,WAAO,KAAKA,GAAL,CAASkC,MAAT,GAAkB,GAAzB;AACD;;AAEW,MAARD,QAAQ,CAACJ,CAAD,EAAI;AACdF,IAAAA,eAAe,CAAC,IAAD,CAAf;;AAEA,QAAI,KAAK3B,GAAL,KAAa,IAAjB,EAAuB;AACrB;AACD;;AAEDT,IAAAA,SAAS,CAAC4C,aAAV,CAAwBN,CAAC,GAAG,GAA5B,EAAiC;AAAE7B,MAAAA,GAAG,EAAE,KAAKA,GAAZ;AAAiBoC,MAAAA,aAAa,EAAE;AAAhC,KAAjC;AACAC,IAAAA,UAAU,CAAC,IAAD,CAAV;AACD;;AAEW,MAARC,QAAQ,GAAG;AACbX,IAAAA,eAAe,CAAC,IAAD,CAAf;;AAEA,QAAI,KAAK3B,GAAL,KAAa,IAAjB,EAAuB;AACrB,aAAO,EAAP;AACD;;AAED,WAAO,KAAKA,GAAL,CAASsC,QAAhB;AACD;;AAEW,MAARA,QAAQ,CAACT,CAAD,EAAI;AACdF,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAR,IAAgBA,GAAG,CAACuC,IAAJ,KAAa,IAA7B,IAAqCvC,GAAG,CAACuC,IAAJ,KAAa,EAAlD,IAAwDvC,GAAG,CAACwC,gBAA5D,IAAgFxC,GAAG,CAACkC,MAAJ,KAAe,MAAnG,EAA2G;AACzG;AACD;;AAED3C,IAAAA,SAAS,CAACkD,cAAV,CAAyBzC,GAAzB,EAA8B6B,CAA9B;AACAQ,IAAAA,UAAU,CAAC,IAAD,CAAV;AACD;;AAEW,MAARK,QAAQ,GAAG;AACbf,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAZ,EAAkB;AAChB,aAAO,EAAP;AACD;;AAED,WAAOA,GAAG,CAAC0C,QAAX;AACD;;AAEW,MAARA,QAAQ,CAACb,CAAD,EAAI;AACdF,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAR,IAAgBA,GAAG,CAACuC,IAAJ,KAAa,IAA7B,IAAqCvC,GAAG,CAACuC,IAAJ,KAAa,EAAlD,IAAwDvC,GAAG,CAACwC,gBAA5D,IAAgFxC,GAAG,CAACkC,MAAJ,KAAe,MAAnG,EAA2G;AACzG;AACD;;AAED3C,IAAAA,SAAS,CAACoD,cAAV,CAAyB3C,GAAzB,EAA8B6B,CAA9B;AACAQ,IAAAA,UAAU,CAAC,IAAD,CAAV;AACD;;AAEO,MAAJE,IAAI,GAAG;AACTZ,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAR,IAAgBA,GAAG,CAACuC,IAAJ,KAAa,IAAjC,EAAuC;AACrC,aAAO,EAAP;AACD;;AAED,QAAIvC,GAAG,CAAC4C,IAAJ,KAAa,IAAjB,EAAuB;AACrB,aAAOrD,SAAS,CAACsD,aAAV,CAAwB7C,GAAG,CAACuC,IAA5B,CAAP;AACD;;AAED,WAAOhD,SAAS,CAACsD,aAAV,CAAwB7C,GAAG,CAACuC,IAA5B,IAAoC,GAApC,GAA0ChD,SAAS,CAACuD,gBAAV,CAA2B9C,GAAG,CAAC4C,IAA/B,CAAjD;AACD;;AAEO,MAAJL,IAAI,CAACV,CAAD,EAAI;AACVF,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAR,IAAgBA,GAAG,CAACwC,gBAAxB,EAA0C;AACxC;AACD;;AAEDjD,IAAAA,SAAS,CAAC4C,aAAV,CAAwBN,CAAxB,EAA2B;AAAE7B,MAAAA,GAAF;AAAOoC,MAAAA,aAAa,EAAE;AAAtB,KAA3B;AACAC,IAAAA,UAAU,CAAC,IAAD,CAAV;AACD;;AAEW,MAARU,QAAQ,GAAG;AACbpB,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAR,IAAgBA,GAAG,CAACuC,IAAJ,KAAa,IAAjC,EAAuC;AACrC,aAAO,EAAP;AACD;;AAED,WAAOhD,SAAS,CAACsD,aAAV,CAAwB7C,GAAG,CAACuC,IAA5B,CAAP;AACD;;AAEW,MAARQ,QAAQ,CAAClB,CAAD,EAAI;AACdF,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAR,IAAgBA,GAAG,CAACwC,gBAAxB,EAA0C;AACxC;AACD;;AAEDjD,IAAAA,SAAS,CAAC4C,aAAV,CAAwBN,CAAxB,EAA2B;AAAE7B,MAAAA,GAAF;AAAOoC,MAAAA,aAAa,EAAE;AAAtB,KAA3B;AACAC,IAAAA,UAAU,CAAC,IAAD,CAAV;AACD;;AAEO,MAAJO,IAAI,GAAG;AACTjB,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAR,IAAgBA,GAAG,CAAC4C,IAAJ,KAAa,IAAjC,EAAuC;AACrC,aAAO,EAAP;AACD;;AAED,WAAOrD,SAAS,CAACuD,gBAAV,CAA2B9C,GAAG,CAAC4C,IAA/B,CAAP;AACD;;AAEO,MAAJA,IAAI,CAACf,CAAD,EAAI;AACVF,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAR,IAAgBA,GAAG,CAACuC,IAAJ,KAAa,IAA7B,IAAqCvC,GAAG,CAACuC,IAAJ,KAAa,EAAlD,IAAwDvC,GAAG,CAACwC,gBAA5D,IAAgFxC,GAAG,CAACkC,MAAJ,KAAe,MAAnG,EAA2G;AACzG;AACD;;AAED,QAAIL,CAAC,KAAK,EAAV,EAAc;AACZ7B,MAAAA,GAAG,CAAC4C,IAAJ,GAAW,IAAX;AACD,KAFD,MAEO;AACLrD,MAAAA,SAAS,CAAC4C,aAAV,CAAwBN,CAAxB,EAA2B;AAAE7B,QAAAA,GAAF;AAAOoC,QAAAA,aAAa,EAAE;AAAtB,OAA3B;AACD;;AACDC,IAAAA,UAAU,CAAC,IAAD,CAAV;AACD;;AAEW,MAARW,QAAQ,GAAG;AACbrB,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAZ,EAAkB;AAChB,aAAO,EAAP;AACD;;AAED,QAAIA,GAAG,CAACwC,gBAAR,EAA0B;AACxB,aAAOxC,GAAG,CAACiD,IAAJ,CAAS,CAAT,CAAP;AACD;;AAED,WAAO,MAAMjD,GAAG,CAACiD,IAAJ,CAASC,IAAT,CAAc,GAAd,CAAb;AACD;;AAEW,MAARF,QAAQ,CAACnB,CAAD,EAAI;AACdF,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAR,IAAgBA,GAAG,CAACwC,gBAAxB,EAA0C;AACxC;AACD;;AAEDxC,IAAAA,GAAG,CAACiD,IAAJ,GAAW,EAAX;AACA1D,IAAAA,SAAS,CAAC4C,aAAV,CAAwBN,CAAxB,EAA2B;AAAE7B,MAAAA,GAAF;AAAOoC,MAAAA,aAAa,EAAE;AAAtB,KAA3B;AACAC,IAAAA,UAAU,CAAC,IAAD,CAAV;AACD;;AAES,MAANc,MAAM,GAAG;AACXxB,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAR,IAAgBA,GAAG,CAACoD,KAAJ,KAAc,IAA9B,IAAsCpD,GAAG,CAACoD,KAAJ,KAAc,EAAxD,EAA4D;AAC1D,aAAO,EAAP;AACD;;AAED,WAAO,MAAMpD,GAAG,CAACoD,KAAjB;AACD;;AAES,MAAND,MAAM,CAACtB,CAAD,EAAI;AACZF,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAZ,EAAkB;AAChB;AACD;;AAED,QAAI6B,CAAC,KAAK,EAAV,EAAc;AACZ7B,MAAAA,GAAG,CAACoD,KAAJ,GAAY,IAAZ;AACD,KAFD,MAEO;AACL,YAAMC,KAAK,GAAGxB,CAAC,CAAC,CAAD,CAAD,KAAS,GAAT,GAAeA,CAAC,CAACyB,SAAF,CAAY,CAAZ,CAAf,GAAgCzB,CAA9C;AACA7B,MAAAA,GAAG,CAACoD,KAAJ,GAAY,EAAZ;AACA7D,MAAAA,SAAS,CAAC4C,aAAV,CAAwBkB,KAAxB,EAA+B;AAC7BrD,QAAAA,GAD6B;AAE7BoC,QAAAA,aAAa,EAAE,OAFc;AAG7BmB,QAAAA,gBAAgB,EAAE,KAAK/C,cAAL,CAAoBgD;AAHT,OAA/B;AAKD;;AACDnB,IAAAA,UAAU,CAAC,IAAD,CAAV;AACD;;AAEO,MAAJoB,IAAI,GAAG;AACT9B,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAR,IAAgBA,GAAG,CAAC0D,QAAJ,KAAiB,IAAjC,IAAyC1D,GAAG,CAAC0D,QAAJ,KAAiB,EAA9D,EAAkE;AAChE,aAAO,EAAP;AACD;;AAED,WAAO,MAAM1D,GAAG,CAAC0D,QAAjB;AACD;;AAEO,MAAJD,IAAI,CAAC5B,CAAD,EAAI;AACVF,IAAAA,eAAe,CAAC,IAAD,CAAf;AACA,UAAM;AAAE3B,MAAAA;AAAF,QAAU,IAAhB;;AAEA,QAAIA,GAAG,KAAK,IAAZ,EAAkB;AAChB;AACD;;AAED,QAAI6B,CAAC,KAAK,EAAV,EAAc;AACZ7B,MAAAA,GAAG,CAAC0D,QAAJ,GAAe,IAAf;AACD,KAFD,MAEO;AACL,YAAML,KAAK,GAAGxB,CAAC,CAAC,CAAD,CAAD,KAAS,GAAT,GAAeA,CAAC,CAACyB,SAAF,CAAY,CAAZ,CAAf,GAAgCzB,CAA9C;AACA7B,MAAAA,GAAG,CAAC0D,QAAJ,GAAe,EAAf;AACAnE,MAAAA,SAAS,CAAC4C,aAAV,CAAwBkB,KAAxB,EAA+B;AAAErD,QAAAA,GAAF;AAAOoC,QAAAA,aAAa,EAAE;AAAtB,OAA/B;AACD;;AACDC,IAAAA,UAAU,CAAC,IAAD,CAAV;AACD;;AAnV0D,CAA7D;;AAsVA,SAASV,eAAT,CAAyBgC,IAAzB,EAA+B;AAC7B,MAAIA,IAAI,CAAC3D,GAAL,KAAa,IAAb,IAAqB2D,IAAI,CAAC3D,GAAL,CAASkC,MAAT,KAAoB,MAAzC,IAAmDyB,IAAI,CAAC3D,GAAL,CAASwC,gBAAhE,EAAkF;AAChF;AACD;;AAEDoB,EAAAA,SAAS,CAACD,IAAD,CAAT;AACD;;AAED,SAASC,SAAT,CAAmBD,IAAnB,EAAyB;AACvB,QAAMnC,IAAI,GAAGmC,IAAI,CAACrD,cAAL,CAAoB,IAApB,EAA0B,MAA1B,CAAb;;AACA,MAAIkB,IAAI,KAAK,IAAb,EAAmB;AACjBmC,IAAAA,IAAI,CAAC3D,GAAL,GAAW,IAAX;AACA;AACD;;AAED,QAAM6D,MAAM,GAAGpE,4BAA4B,CAAC+B,IAAD,EAAOmC,IAAI,CAACnD,cAAZ,CAA3C;AAEAmD,EAAAA,IAAI,CAAC3D,GAAL,GAAW6D,MAAM,KAAK,IAAX,GAAkB,IAAlB,GAAyBA,MAApC;AACD;;AAED,SAASxB,UAAT,CAAoBsB,IAApB,EAA0B;AACxBA,EAAAA,IAAI,CAAC7B,cAAL,CAAoB,IAApB,EAA0B,MAA1B,EAAkCvC,SAAS,CAACqC,YAAV,CAAuB+B,IAAI,CAAC3D,GAA5B,CAAlC;AACD","sourcesContent":["\"use strict\";\nconst whatwgURL = require(\"whatwg-url\");\nconst { parseURLToResultingURLRecord } = require(\"../helpers/document-base-url\");\nconst { asciiCaseInsensitiveMatch } = require(\"../helpers/strings\");\nconst { navigate } = require(\"../window/navigation\");\n\nexports.implementation = class HTMLHyperlinkElementUtilsImpl {\n  _htmlHyperlinkElementUtilsSetup() {\n    this.url = null;\n  }\n\n  // https://html.spec.whatwg.org/multipage/links.html#cannot-navigate\n  _cannotNavigate() {\n    // TODO: Correctly check if the document is fully active\n    return this._localName !== \"a\" && !this.isConnected;\n  }\n\n  // https://html.spec.whatwg.org/multipage/semantics.html#get-an-element's-target\n  _getAnElementsTarget() {\n    if (this.hasAttributeNS(null, \"target\")) {\n      return this.getAttributeNS(null, \"target\");\n    }\n\n    const baseEl = this._ownerDocument.querySelector(\"base[target]\");\n\n    if (baseEl) {\n      return baseEl.getAttributeNS(null, \"target\");\n    }\n\n    return \"\";\n  }\n\n  // https://html.spec.whatwg.org/multipage/browsers.html#the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name\n  _chooseABrowsingContext(name, current) {\n    let chosen = null;\n\n    if (name === \"\" || asciiCaseInsensitiveMatch(name, \"_self\")) {\n      chosen = current;\n    } else if (asciiCaseInsensitiveMatch(name, \"_parent\")) {\n      chosen = current.parent;\n    } else if (asciiCaseInsensitiveMatch(name, \"_top\")) {\n      chosen = current.top;\n    } else if (!asciiCaseInsensitiveMatch(name, \"_blank\")) {\n      // https://github.com/whatwg/html/issues/1440\n    }\n\n    // TODO: Create new browsing context, handle noopener\n\n    return chosen;\n  }\n\n  // https://html.spec.whatwg.org/multipage/links.html#following-hyperlinks-2\n  _followAHyperlink() {\n    if (this._cannotNavigate()) {\n      return;\n    }\n\n    const source = this._ownerDocument._defaultView;\n    let targetAttributeValue = \"\";\n\n    if (this._localName === \"a\" || this._localName === \"area\") {\n      targetAttributeValue = this._getAnElementsTarget();\n    }\n\n    const noopener = this.relList.contains(\"noreferrer\") || this.relList.contains(\"noopener\");\n\n    const target = this._chooseABrowsingContext(targetAttributeValue, source, noopener);\n\n    if (target === null) {\n      return;\n    }\n\n    const url = parseURLToResultingURLRecord(this.href, this._ownerDocument);\n\n    if (url === null) {\n      return;\n    }\n\n    // TODO: Handle hyperlink suffix and referrerpolicy\n    setTimeout(() => {\n      navigate(target, url, {});\n    }, 0);\n  }\n\n  toString() {\n    return this.href;\n  }\n\n  get href() {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null) {\n      const href = this.getAttributeNS(null, \"href\");\n      return href === null ? \"\" : href;\n    }\n\n    return whatwgURL.serializeURL(url);\n  }\n\n  set href(v) {\n    this.setAttributeNS(null, \"href\", v);\n  }\n\n  get origin() {\n    reinitializeURL(this);\n\n    if (this.url === null) {\n      return \"\";\n    }\n\n    return whatwgURL.serializeURLOrigin(this.url);\n  }\n\n  get protocol() {\n    reinitializeURL(this);\n\n    if (this.url === null) {\n      return \":\";\n    }\n\n    return this.url.scheme + \":\";\n  }\n\n  set protocol(v) {\n    reinitializeURL(this);\n\n    if (this.url === null) {\n      return;\n    }\n\n    whatwgURL.basicURLParse(v + \":\", { url: this.url, stateOverride: \"scheme start\" });\n    updateHref(this);\n  }\n\n  get username() {\n    reinitializeURL(this);\n\n    if (this.url === null) {\n      return \"\";\n    }\n\n    return this.url.username;\n  }\n\n  set username(v) {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null || url.host === null || url.host === \"\" || url.cannotBeABaseURL || url.scheme === \"file\") {\n      return;\n    }\n\n    whatwgURL.setTheUsername(url, v);\n    updateHref(this);\n  }\n\n  get password() {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null) {\n      return \"\";\n    }\n\n    return url.password;\n  }\n\n  set password(v) {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null || url.host === null || url.host === \"\" || url.cannotBeABaseURL || url.scheme === \"file\") {\n      return;\n    }\n\n    whatwgURL.setThePassword(url, v);\n    updateHref(this);\n  }\n\n  get host() {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null || url.host === null) {\n      return \"\";\n    }\n\n    if (url.port === null) {\n      return whatwgURL.serializeHost(url.host);\n    }\n\n    return whatwgURL.serializeHost(url.host) + \":\" + whatwgURL.serializeInteger(url.port);\n  }\n\n  set host(v) {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null || url.cannotBeABaseURL) {\n      return;\n    }\n\n    whatwgURL.basicURLParse(v, { url, stateOverride: \"host\" });\n    updateHref(this);\n  }\n\n  get hostname() {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null || url.host === null) {\n      return \"\";\n    }\n\n    return whatwgURL.serializeHost(url.host);\n  }\n\n  set hostname(v) {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null || url.cannotBeABaseURL) {\n      return;\n    }\n\n    whatwgURL.basicURLParse(v, { url, stateOverride: \"hostname\" });\n    updateHref(this);\n  }\n\n  get port() {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null || url.port === null) {\n      return \"\";\n    }\n\n    return whatwgURL.serializeInteger(url.port);\n  }\n\n  set port(v) {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null || url.host === null || url.host === \"\" || url.cannotBeABaseURL || url.scheme === \"file\") {\n      return;\n    }\n\n    if (v === \"\") {\n      url.port = null;\n    } else {\n      whatwgURL.basicURLParse(v, { url, stateOverride: \"port\" });\n    }\n    updateHref(this);\n  }\n\n  get pathname() {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null) {\n      return \"\";\n    }\n\n    if (url.cannotBeABaseURL) {\n      return url.path[0];\n    }\n\n    return \"/\" + url.path.join(\"/\");\n  }\n\n  set pathname(v) {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null || url.cannotBeABaseURL) {\n      return;\n    }\n\n    url.path = [];\n    whatwgURL.basicURLParse(v, { url, stateOverride: \"path start\" });\n    updateHref(this);\n  }\n\n  get search() {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null || url.query === null || url.query === \"\") {\n      return \"\";\n    }\n\n    return \"?\" + url.query;\n  }\n\n  set search(v) {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null) {\n      return;\n    }\n\n    if (v === \"\") {\n      url.query = null;\n    } else {\n      const input = v[0] === \"?\" ? v.substring(1) : v;\n      url.query = \"\";\n      whatwgURL.basicURLParse(input, {\n        url,\n        stateOverride: \"query\",\n        encodingOverride: this._ownerDocument.charset\n      });\n    }\n    updateHref(this);\n  }\n\n  get hash() {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null || url.fragment === null || url.fragment === \"\") {\n      return \"\";\n    }\n\n    return \"#\" + url.fragment;\n  }\n\n  set hash(v) {\n    reinitializeURL(this);\n    const { url } = this;\n\n    if (url === null) {\n      return;\n    }\n\n    if (v === \"\") {\n      url.fragment = null;\n    } else {\n      const input = v[0] === \"#\" ? v.substring(1) : v;\n      url.fragment = \"\";\n      whatwgURL.basicURLParse(input, { url, stateOverride: \"fragment\" });\n    }\n    updateHref(this);\n  }\n};\n\nfunction reinitializeURL(hheu) {\n  if (hheu.url !== null && hheu.url.scheme === \"blob\" && hheu.url.cannotBeABaseURL) {\n    return;\n  }\n\n  setTheURL(hheu);\n}\n\nfunction setTheURL(hheu) {\n  const href = hheu.getAttributeNS(null, \"href\");\n  if (href === null) {\n    hheu.url = null;\n    return;\n  }\n\n  const parsed = parseURLToResultingURLRecord(href, hheu._ownerDocument);\n\n  hheu.url = parsed === null ? null : parsed;\n}\n\nfunction updateHref(hheu) {\n  hheu.setAttributeNS(null, \"href\", whatwgURL.serializeURL(hheu.url));\n}\n"]},"metadata":{},"sourceType":"script"}