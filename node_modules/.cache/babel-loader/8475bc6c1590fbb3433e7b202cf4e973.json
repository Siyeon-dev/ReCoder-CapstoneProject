{"ast":null,"code":"\"use strict\";\n\nconst {\n  HTML_NS\n} = require(\"./namespaces\");\n\nconst {\n  createElement,\n  getValidTagNames\n} = require(\"./create-element\");\n\nconst {\n  implForWrapper,\n  wrapperForImpl\n} = require(\"../generated/utils\"); // https://html.spec.whatwg.org/multipage/custom-elements.html#concept-already-constructed-marker\n\n\nconst ALREADY_CONSTRUCTED_MARKER = Symbol(\"already-constructed-marker\"); // https://html.spec.whatwg.org/multipage/dom.html#htmlconstructor\n\nfunction HTMLConstructor(globalObject, constructorName, newTarget) {\n  const registry = implForWrapper(globalObject.customElements);\n\n  if (newTarget === HTMLConstructor) {\n    throw new TypeError(\"Invalid constructor\");\n  }\n\n  const definition = registry._customElementDefinitions.find(entry => entry.ctor === newTarget);\n\n  if (definition === undefined) {\n    throw new TypeError(\"Invalid constructor, the constructor is not part of the custom element registry\");\n  }\n\n  let isValue = null;\n\n  if (definition.localName === definition.name) {\n    if (constructorName !== \"HTMLElement\") {\n      throw new TypeError(\"Invalid constructor, autonomous custom element should extend from HTMLElement\");\n    }\n  } else {\n    const validLocalNames = getValidTagNames(HTML_NS, constructorName);\n\n    if (!validLocalNames.includes(definition.localName)) {\n      throw new TypeError(`${definition.localName} is not valid local name for ${constructorName}`);\n    }\n\n    isValue = definition.name;\n  }\n\n  let {\n    prototype\n  } = newTarget;\n\n  if (prototype === null || typeof prototype !== \"object\") {\n    // The following line deviates from the specification. The HTMLElement prototype should be retrieved from the realm\n    // associated with the \"new.target\". Because it is impossible to get such information in jsdom, we fallback to the\n    // HTMLElement prototype associated with the current object.\n    prototype = globalObject.HTMLElement.prototype;\n  }\n\n  if (definition.constructionStack.length === 0) {\n    const documentImpl = implForWrapper(globalObject.document);\n    const elementImpl = createElement(documentImpl, definition.localName, HTML_NS);\n    const element = wrapperForImpl(elementImpl);\n    Object.setPrototypeOf(element, prototype);\n    elementImpl._ceState = \"custom\";\n    elementImpl._ceDefinition = definition;\n    elementImpl._isValue = isValue;\n    return element;\n  }\n\n  const elementImpl = definition.constructionStack[definition.constructionStack.length - 1];\n  const element = wrapperForImpl(elementImpl);\n\n  if (elementImpl === ALREADY_CONSTRUCTED_MARKER) {\n    throw new TypeError(\"This instance is already constructed\");\n  }\n\n  Object.setPrototypeOf(element, prototype);\n  definition.constructionStack[definition.constructionStack.length - 1] = ALREADY_CONSTRUCTED_MARKER;\n  return element;\n}\n\nmodule.exports = {\n  HTMLConstructor\n};","map":{"version":3,"sources":["/Library/WebServer/Documents/capstone/capstone-project-re-coder/node_modules/jsdom/lib/jsdom/living/helpers/html-constructor.js"],"names":["HTML_NS","require","createElement","getValidTagNames","implForWrapper","wrapperForImpl","ALREADY_CONSTRUCTED_MARKER","Symbol","HTMLConstructor","globalObject","constructorName","newTarget","registry","customElements","TypeError","definition","_customElementDefinitions","find","entry","ctor","undefined","isValue","localName","name","validLocalNames","includes","prototype","HTMLElement","constructionStack","length","documentImpl","document","elementImpl","element","Object","setPrototypeOf","_ceState","_ceDefinition","_isValue","module","exports"],"mappings":"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","sourcesContent":["\"use strict\";\n\nconst { HTML_NS } = require(\"./namespaces\");\nconst { createElement, getValidTagNames } = require(\"./create-element\");\n\nconst { implForWrapper, wrapperForImpl } = require(\"../generated/utils\");\n\n// https://html.spec.whatwg.org/multipage/custom-elements.html#concept-already-constructed-marker\nconst ALREADY_CONSTRUCTED_MARKER = Symbol(\"already-constructed-marker\");\n\n// https://html.spec.whatwg.org/multipage/dom.html#htmlconstructor\nfunction HTMLConstructor(globalObject, constructorName, newTarget) {\n  const registry = implForWrapper(globalObject.customElements);\n  if (newTarget === HTMLConstructor) {\n    throw new TypeError(\"Invalid constructor\");\n  }\n\n  const definition = registry._customElementDefinitions.find(entry => entry.ctor === newTarget);\n  if (definition === undefined) {\n    throw new TypeError(\"Invalid constructor, the constructor is not part of the custom element registry\");\n  }\n\n  let isValue = null;\n\n  if (definition.localName === definition.name) {\n    if (constructorName !== \"HTMLElement\") {\n      throw new TypeError(\"Invalid constructor, autonomous custom element should extend from HTMLElement\");\n    }\n  } else {\n    const validLocalNames = getValidTagNames(HTML_NS, constructorName);\n    if (!validLocalNames.includes(definition.localName)) {\n      throw new TypeError(`${definition.localName} is not valid local name for ${constructorName}`);\n    }\n\n    isValue = definition.name;\n  }\n\n  let { prototype } = newTarget;\n\n  if (prototype === null || typeof prototype !== \"object\") {\n    // The following line deviates from the specification. The HTMLElement prototype should be retrieved from the realm\n    // associated with the \"new.target\". Because it is impossible to get such information in jsdom, we fallback to the\n    // HTMLElement prototype associated with the current object.\n    prototype = globalObject.HTMLElement.prototype;\n  }\n\n  if (definition.constructionStack.length === 0) {\n    const documentImpl = implForWrapper(globalObject.document);\n\n    const elementImpl = createElement(documentImpl, definition.localName, HTML_NS);\n\n    const element = wrapperForImpl(elementImpl);\n    Object.setPrototypeOf(element, prototype);\n\n    elementImpl._ceState = \"custom\";\n    elementImpl._ceDefinition = definition;\n    elementImpl._isValue = isValue;\n\n    return element;\n  }\n\n  const elementImpl = definition.constructionStack[definition.constructionStack.length - 1];\n  const element = wrapperForImpl(elementImpl);\n\n  if (elementImpl === ALREADY_CONSTRUCTED_MARKER) {\n    throw new TypeError(\"This instance is already constructed\");\n  }\n\n  Object.setPrototypeOf(element, prototype);\n\n  definition.constructionStack[definition.constructionStack.length - 1] = ALREADY_CONSTRUCTED_MARKER;\n\n  return element;\n}\n\nmodule.exports = {\n  HTMLConstructor\n};\n"]},"metadata":{},"sourceType":"script"}